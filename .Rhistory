library(readr)
Integrated_spreadsheet <- read_csv("~/GitHub/EV/Data/Integrated_spreadsheet.csv")
View(Integrated_spreadsheet)
attach(Integrated_Spreadsheet)
library(readr)
Integrated_Spreadsheet <- read_csv("~/GitHub/EV/Data/Integrated_Spreadsheet.csv")
View(Integrated_Spreadsheet)
attach(Integrated_Spreadsheet)
mod1 <- lm(TPEV1k ~ MeanAge + Level4 + SelfEmp)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
library(psych)
library(car)
library(ggplot2)
library(Hmisc)
library(corrplot)
mod1 <- lm(TPEV1k ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(PPEV1k ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(ln(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PBEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PHEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PBEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(TPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + FullTime + MedianY + TwoCar + CarDrive + PopDens + Flat + MeanRes)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + Flat + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ Log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) + log(OneCar) + log(CarDrive) + log(PopDens) + Log(SemiD) + log(MeanRes) + log(PHEV1k))
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) + log(OneCar) + log(CarDrive) + log(PopDens) + Log(SemiD) + log(MeanRes) + log(PHEV1k))
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) + log(OneCar) + log(CarDrive) + log(PopDens) + log(SemiD) + log(MeanRes) + log(PHEV1k))
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) + log(OneCar) + log(CarDrive) + log(PopDens) + log(SemiD) + log(MeanRes) + log(PHEV1k))
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + lPHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
attach(Integrated_Spreadsheet)
library(readr)
Integrated_Spreadsheet <- read_csv("~/GitHub/EV/Data/Integrated_Spreadsheet.csv")
View(Integrated_Spreadsheet)
attach(Integrated_Spreadsheet)
mod1 <- lm(log(PPHEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ MedianAge)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPHEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PBEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) + log(OneCar) + log(CarDrive) + log(PopDens) + log(SemiD) + log(MeanRes) + log(PHEV1k))
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
hist(PPEV1k, breaks = 50, xlab = "Hybrid Electric Vehicles per thousand cars", main = NULL, font.lab = 2, col = "gray80")
hist(PBEV1k, breaks = 50, xlab = "Private Pure Battery Electric Vehicles per thousand cars", main = NULL, font.lab = 2, col = "gray80")
hist(PPHEV1k, breaks = 50, xlab = "Private Plug-in Hybrid Electric Vehicles per thousand cars", main = NULL, font.lab = 2, col = "gray80")
mod1 <- lm(log(PPEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) + log(OneCar) + log(CarDrive) + log(PopDens) + log(SemiD) + log(MeanRes) + log(PHEV1k))
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Demographic Model")
vif(mod1)
anova(mod1)
library(readr)
Integrated_Spreadsheet_contiguous <- read_csv("~/GitHub/EV/Data/Integrated_Spreadsheet_contiguous.csv")
View(Integrated_Spreadsheet_contiguous)
attach(Integrated_Spreadsheet_contiguous)
library(psych)
library(car)
library(ggplot2)
library(Hmisc)
library(corrplot)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + )
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Benchmark OLS Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Benchmark OLS Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Benchmark OLS Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Benchmark OLS Model")
vif(mod1)
anova(mod1)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Benchmark OLS Model")
vif(mod1)
anova(mod1)
library(spdep)
library(rgdal)
library(maptools)
library(RColorBrewer)
library(tmap)
setwd("~/GitHub/EV")
SpatDat <- readOGR("Shapefiles","LAD_DEC_2012_GB_BGC_Linked")
col.ramp <- brewer.pal(n = 6, name = "OrRd")
spplot(SpatDat,'PropDiesel', col = "transparent", main = "Proportion of Local Car Fleet Fuelled by Diesel")
spplot(SpatDat,'IS_PPEV1k', col = "transparent", main = "Proportion of Local Car Fleet Fuelled by Diesel")
tm_shape(SpatDat) +
tm_polygons("IS_PPEV1k", style="quantile", title="Private Plug-in Electric Vehicles (per '000 cars)", n = 10)
tmap_mode("view")
last_map()
continuity.nb <- poly2nb(SpatDat, queen = TRUE)
plot(SpatDat, border = "grey")
plot(continuity.nb, coordinates(SpatDat), add = TRUE, col = "blue")
continuity.listw <- nb2listw(continuity.nb)
summary(continuity.listw)
moran.test(SpatDat$IS_PropDie,continuity.listw, randomisation=FALSE, alternative="two.sided")
moran.plot(SpatDat$IS_PropDie, continuity.listw)
LMIresult <- localmoran(SpatDat$IS_PropDie, continuity.listw)
LMImap <- spCbind(SpatDat, as.data.frame(LMIresult))
spplot(LMImap, "Z.Ii")
moran.test(SpatDat$IS_PPEV1k,continuity.listw, randomisation=FALSE, alternative="two.sided")
moran.plot(SpatDat$IS_PPEV1k, continuity.listw)
LMIresult <- localmoran(SpatDat$IS_PPEV1k, continuity.listw)
LMImap <- spCbind(SpatDat, as.data.frame(LMIresult))
spplot(LMImap, "Z.Ii")
mod7SLM <- lagsarlm(log(IS_PPEV1k) ~ IS_MedianA + IS_Level4 + IS_SelfEmp + IS_MedianY +
IS_OneCar + IS_CarDriv + IS_PopDens + IS_SemiD + IS_MeanRes + IS_PHEV1k + IS_TotCPoi,
data = SpatDat, continuity.listw)
summary(mod7SLM)
mod7SLM <- lagsarlm(IS_PPEV1k ~ IS_MedianA + IS_Level4 + IS_SelfEmp + IS_MedianY +
IS_OneCar + IS_CarDriv + IS_PopDens + IS_SemiD + IS_MeanRes + IS_PHEV1k + IS_TotCPoi,
data = SpatDat, continuity.listw)
summary(mod7SLM)
library(spdep)
library(rgdal)
library(maptools)
library(RColorBrewer)
library(tmap)
setwd("~/GitHub/EV")
SpatDat <- readOGR("Shapefiles","LAD_DEC_2012_GB_BGC_Linked")
tm_shape(SpatDat) +
tm_polygons("PPEV1k", style="quantile", title="Private Plug-in Electric Vehicles (per '000 cars)", n = 10)
tmap_mode("view")
last_map()
library(spdep)
library(rgdal)
library(maptools)
library(RColorBrewer)
library(tmap)
setwd("~/GitHub/EV")
SpatDat <- readOGR("Shapefiles","LAD_DEC_2012_GB_BGC_Linked")
tm_shape(SpatDat) +
tm_polygons("PPEV1k", style="quantile", title="Private Plug-in Electric Vehicles (per '000 cars)", n = 10)
tmap_mode("view")
last_map()
continuity.nb <- poly2nb(SpatDat, queen = TRUE)
plot(SpatDat, border = "grey")
plot(continuity.nb, coordinates(SpatDat), add = TRUE, col = "blue")
continuity.listw <- nb2listw(continuity.nb)
summary(continuity.listw)
mod7SLM <- lagsarlm(PPEV1k ~ MedianAge + Level4 + SelfEmp + MedianY +
OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint,
data = SpatDat, continuity.listw)
summary(mod7SLM)
library(psych)
library(car)
library(ggplot2)
library(Hmisc)
library(corrplot)
attach(Integrated_Spreadsheet_contiguous)
library(readr)
Integrated_Spreadsheet_contiguous <- read_csv("~/GitHub/EV/Data/Integrated_Spreadsheet_contiguous.csv")
View(Integrated_Spreadsheet_contiguous)
attach(Integrated_Spreadsheet_contiguous)
mod1 <- lm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY + OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1, main = "Benchmark OLS Model")
vif(mod1)
anova(mod1)
#Spatial Error Model
mod7SEM <- errorsarlm(PPEV1k ~ MedianAge + Level4 + SelfEmp + MedianY +
OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint,
data = SpatDat, continuity.listw)
summary(mod7SEM)
#Spatial Durbin Model
mod7SDM <- lagsarlm(PropDiesLN ~ MeanAgeLN + SelfEmpLN + Level4LN + OneCarLN +
CarDrivLN + Over30LN + PopDLN + MeanResLN + RentSocLN + FlatsLN + NetDistLN,
data = SpatDat, continuity.listw, type = "mixed")
summary(mod7SDM)
W <- as(continuity.listw, "CsparseMatrix")
trMatc <- trW(W, type = "mult")
summary(impacts(mod7SDM, tr=trMatc, R=200), zstats=TRUE, short = TRUE)
mod7SDM <- lagsarlm(PPEV1k ~ MedianAge + Level4 + SelfEmp + MedianY +
OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint,
data = SpatDat, continuity.listw, type = "mixed")
summary(mod7SDM)
W <- as(continuity.listw, "CsparseMatrix")
trMatc <- trW(W, type = "mult")
summary(impacts(mod7SDM, tr=trMatc, R=200), zstats=TRUE, short = TRUE)
mod7SDEM <- errorsarlm(PPEV1k ~ MedianAge + Level4 + SelfEmp + MedianY +
OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint,
data = SpatDat, continuity.listw, etype = "emixed")
summary(mod7SDEM)
summary(impacts(mod7SDEM))
mod7SLM <- lagsarlm(log(PPEV1k) ~ MedianAge + Level4 + SelfEmp + MedianY +
OneCar + CarDrive + PopDens + SemiD + MeanRes + PHEV1k + TotCPoint,
data = SpatDat, continuity.listw)
summary(mod7SLM)
