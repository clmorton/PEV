{
    "collab_server" : "",
    "contents" : "#Load Packages\nlibrary(spdep)\nlibrary(rgdal)\nlibrary(maptools)\nlibrary(RColorBrewer)\nlibrary(tmap)\n\n#Load Data\nsetwd(\"~/GitHub/PEV\")\nSpatDat <- readOGR(\"Shapefiles\",\"LAD_DEC_2012_GB_BGC_Linked\")\nsummary(SpatDat)\n\n#Choropleth Map of Private Plug-in Electric Vehicles (per '000 cars)\ncol.ramp <- brewer.pal(n = 6, name = \"OrRd\")\nspplot(SpatDat,'PPEV1k', col = \"transparent\", main = \"Private Plug-in Electric Vehicles (per '000 cars)\")\n\ntm_shape(SpatDat) +\n  tm_polygons(\"PPEV1k\", style=\"quantile\", title=\"Private Plug-in Electric Vehicles (per '000 cars)\", n = 10)\ntmap_mode(\"view\")\nlast_map()\n\n#Create Spatial Weights\ncontinuity.nb <- poly2nb(SpatDat, queen = TRUE)\nplot(SpatDat, border = \"grey\")\nplot(continuity.nb, coordinates(SpatDat), add = TRUE, col = \"blue\")\ncontinuity.listw <- nb2listw(continuity.nb)\nsummary(continuity.listw)\n\n#Autocorrelation Analysis\nmoran.test(SpatDat$PPEV1k,continuity.listw, randomisation=FALSE, alternative=\"two.sided\")\nmoran.plot(SpatDat$PPEV1k, continuity.listw)\nLMIresult <- localmoran(SpatDat$PPEV1k, continuity.listw)\nLMImap <- spCbind(SpatDat, as.data.frame(LMIresult))\nspplot(LMImap, \"Z.Ii\")\n\n#Spatial log-normal Regression Models\n\n#Spatial Lag Model\nmod7SLM <- lagsarlm(log(PPEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) +\n                        log(PopDens) + log(SemiD) + log(MeanRes) + log(OneCar) + log(CarDrive) + log(PHEV1k) + TotCPoint, \n                    data = SpatDat, continuity.listw)\nsummary(mod7SLM)\n\n#Spatial Error Model\nmod7SEM <- errorsarlm(log(PPEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) +\n                        log(PopDens) + log(SemiD) + log(MeanRes) + log(OneCar) + log(CarDrive) + log(PHEV1k) + TotCPoint, \n                      data = SpatDat, continuity.listw)\nsummary(mod7SEM)\n\n#Spatial Durbin Model\nmod7SDM <- lagsarlm(log(PPEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) +\n                      log(PopDens) + log(SemiD) + log(MeanRes) + log(OneCar) + log(CarDrive) + log(PHEV1k) + TotCPoint, \n                    data = SpatDat, continuity.listw, type = \"mixed\")\nsummary(mod7SDM)\nW <- as(continuity.listw, \"CsparseMatrix\")\ntrMatc <- trW(W, type = \"mult\")\nsummary(impacts(mod7SDM, tr=trMatc, R=200), zstats=TRUE, short = TRUE)\n\n#Spatial Durbin Error Model\nmod7SDEM <- errorsarlm(log(PPEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) +\n                         log(PopDens) + log(SemiD) + log(MeanRes) + log(OneCar) + log(CarDrive) + log(PHEV1k) + TotCPoint, \n                      data = SpatDat, continuity.listw, etype = \"emixed\")\nsummary(mod7SDEM)\nsummary(impacts(mod7SDEM))\n\n#Simultaneous Autoregressive Model\nmod7SAR <- spautolm(log(PPEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) +\n                      log(PopDens) + log(SemiD) + log(MeanRes) + log(OneCar) + log(CarDrive) + log(PHEV1k) + TotCPoint, \n                    data = SpatDat, listw = continuity.listw, family = \"SAR\", method = \"eigen\")\nsummary(mod7SAR)\nmod7resSAR <- MCMCsamp(mod7SAR, mcmc = 5000, burnin = 500, listw = continuity.listw)\nsummary(mod7resSAR)\n\n#Conditional Autoregressive Model\nmod7CAR <- spautolm(log(PPEV1k) ~ log(MedianAge) + log(Level4) + log(SelfEmp) + log(MedianY) +\n                      log(PopDens) + log(SemiD) + log(MeanRes) + log(OneCar) + log(CarDrive) + log(PHEV1k) + TotCPoint, \n                    data = SpatDat, listw = continuity.listw, family = \"CAR\", method = \"eigen\")\nsummary(mod7CAR)\nmod7resCAR <- MCMCsamp(mod7CAR, mcmc = 5000, burnin = 500, listw = continuity.listw)\nsummary(mod7resCAR)\n",
    "created" : 1507369354519.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2344141631",
    "id" : "99D050C1",
    "lastKnownWriteTime" : 1509635326,
    "last_content_update" : 1509635326475,
    "path" : "~/GitHub/PEV/Code/Spatial Regression.R",
    "project_path" : "Code/Spatial Regression.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}